# OPML Gardener 使用指南

## 📚 目录
- [快速开始](#快速开始)
- [核心功能](#核心功能)
- [操作指南](#操作指南)
- [常见问题](#常见问题)
- [技术细节](#技术细节)

---

## 🚀 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 启动开发服务器

```bash
npm run dev
```

### 3. 打开浏览器

访问 http://localhost:3000

### 4. 测试应用

项目中包含了一个示例 OPML 文件 `example.opml`，您可以用它来测试应用的各项功能。

---

## ✨ 核心功能

### 1. 导入 OPML 文件
- **拖拽上传**: 直接将 `.opml` 文件拖放到上传区域
- **点击选择**: 点击上传区域选择本地文件
- **自动解析**: 系统会自动解析 OPML 的嵌套结构

### 2. 查看和编辑订阅源
- **表格视图**: 清晰展示所有订阅源信息
- **实时编辑**: 点击任意字段即可编辑
- **分类管理**: 使用下拉菜单更改订阅源分类

### 3. 搜索和筛选
- **全局搜索**: 在搜索框输入关键词，搜索标题或 URL
- **分类筛选**: 点击侧边栏的分类快速筛选
- **实时过滤**: 搜索和筛选结果实时更新

### 4. 批量操作
- **全选/取消全选**: 使用表头的复选框
- **批量选择**: 勾选多个订阅源
- **批量导出**: 仅导出选中的订阅源

### 5. 去重功能
- **自动检测**: 基于 RSS URL 检测重复项
- **一键删除**: 点击"去除重复"按钮自动清理

### 6. 导出功能
- **导出全部**: 导出所有订阅源
- **导出已选**: 仅导出选中的订阅源
- **OPML 格式**: 导出标准 OPML 2.0 格式文件

---

## 📖 操作指南

### 导入 OPML 文件

1. 打开应用首页
2. 将 OPML 文件拖放到上传区域，或点击"选择文件"按钮
3. 系统会自动解析并显示所有订阅源

**支持的 OPML 结构**:
```xml
<opml version="2.0">
  <body>
    <outline text="分类名称">
      <outline text="订阅源标题" xmlUrl="RSS地址" htmlUrl="网站地址" />
    </outline>
  </body>
</opml>
```

### 编辑订阅源

#### 修改标题
1. 点击标题单元格
2. 输入新标题
3. 点击其他地方或按 Enter 保存

#### 更改分类
1. 点击分类下拉菜单
2. 选择目标分类
3. 自动保存

#### 修改链接
1. 点击 RSS 链接或网站链接单元格
2. 输入新 URL
3. 点击其他地方或按 Enter 保存

### 使用搜索和筛选

#### 搜索
1. 在侧边栏顶部的搜索框输入关键词
2. 系统会在标题和 URL 中搜索
3. 清空搜索框恢复显示所有订阅源

#### 按分类筛选
1. 点击侧边栏的分类名称
2. 表格会只显示该分类的订阅源
3. 点击"全部分类"恢复显示所有订阅源

#### 组合使用
- 可以同时使用搜索和分类筛选
- 两种筛选条件会同时生效

### 批量操作订阅源

#### 全选所有订阅源
1. 点击表头的复选框
2. 所有当前显示的订阅源会被选中

#### 选择特定订阅源
1. 勾选需要操作的订阅源
2. 已选数量会显示在页面顶部

#### 导出选中的订阅源
1. 选中需要导出的订阅源
2. 点击侧边栏的"导出已选"按钮
3. 浏览器会自动下载 OPML 文件

### 去除重复订阅源

1. 点击侧边栏的"去除重复"按钮
2. 系统会检测具有相同 RSS URL 的订阅源
3. 保留第一个，删除其余重复项
4. 显示删除的数量

### 导出订阅源

#### 导出全部
1. 点击"导出全部"按钮
2. 下载包含所有订阅源的 OPML 文件

#### 导出已选
1. 选中需要导出的订阅源
2. 点击"导出已选"按钮
3. 下载仅包含选中订阅源的 OPML 文件

---

## ❓ 常见问题

### Q: 支持哪些 OPML 格式？
A: 支持标准的 OPML 1.0 和 2.0 格式。文件必须包含 `<opml>` 根元素和 `<body>` 元素。

### Q: 数据会上传到服务器吗？
A: 不会。所有数据处理都在浏览器本地完成，完全离线可用，保护您的隐私。

### Q: 可以编辑多少个订阅源？
A: 理论上没有限制，但浏览器性能可能会影响处理大量订阅源（如超过 10,000 个）时的体验。

### Q: 导出的 OPML 文件可以在其他 RSS 阅读器使用吗？
A: 可以。导出的是标准 OPML 2.0 格式，兼容大部分主流 RSS 阅读器。

### Q: 如何添加新的分类？
A: 目前版本中，分类来自于导入的 OPML 文件。您可以在编辑订阅源时，在分类下拉菜单中手动输入新分类名称（功能待实现）。临时方案是修改某个订阅源的分类为新名称。

### Q: 可以撤销删除操作吗？
A: 当前版本不支持撤销。建议在删除前先导出备份。

---

## 🔧 技术细节

### 项目架构

```
OPMLGardener/
├── app/                    # Next.js App Router
│   ├── layout.tsx         # 根布局
│   ├── page.tsx           # 主页面（Dashboard）
│   └── globals.css        # 全局样式
├── components/            # React 组件
│   ├── ui/               # shadcn/ui 基础组件
│   ├── OpmlUploader.tsx  # 文件上传组件
│   ├── FeedTable.tsx     # 订阅源表格
│   └── FilterSidebar.tsx # 筛选侧边栏
├── hooks/                # 自定义 Hooks
│   └── useOpml.ts        # OPML 状态管理
├── lib/                  # 工具函数
│   ├── utils.ts          # 通用工具
│   └── opml-parser.ts    # OPML 解析和导出
└── types/                # TypeScript 类型
    └── index.ts          # 类型定义
```

### 核心依赖

- **Next.js 14**: React 框架，使用 App Router
- **TypeScript**: 类型安全
- **Tailwind CSS**: 实用优先的 CSS 框架
- **shadcn/ui**: 可复用的 UI 组件
- **fast-xml-parser**: OPML XML 解析
- **Lucide React**: 图标库

### 数据流

1. **导入**: OPML 文件 → XML 解析 → FeedItem 数组
2. **编辑**: 用户操作 → 更新状态 → 重新渲染
3. **导出**: FeedItem 数组 → 分组 → XML 构建 → 下载

### 状态管理

使用 `useOpml` Hook 集中管理所有订阅源状态和操作：
- 导入/导出
- CRUD 操作
- 搜索和筛选
- 批量操作

---

## 🎯 未来功能规划

### 短期计划
- [ ] 添加撤销/重做功能
- [ ] 支持手动添加新分类
- [ ] 导出前预览功能
- [ ] 深色模式

### 长期计划
- [ ] RSS 链接有效性检查
- [ ] 订阅源标签系统
- [ ] 导入/导出 JSON 格式
- [ ] 订阅源分组功能
- [ ] 订阅源排序功能

---

## 🆘 获取帮助

如遇到问题：
1. 查看本指南的常见问题部分
2. 查看 README.md 文件
3. 提交 GitHub Issue（如果项目已开源）

---

**祝您使用愉快！** 🎉

