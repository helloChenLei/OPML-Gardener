# ğŸš€ OPML Gardener éƒ¨ç½²æŒ‡å—

OPML Gardener æ˜¯ä¸€ä¸ªçº¯å®¢æˆ·ç«¯åº”ç”¨ï¼Œæ‰€æœ‰æ•°æ®å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥è½»æ¾åœ°å°†å…¶éƒ¨ç½²åˆ°å„ç§é™æ€æ‰˜ç®¡å¹³å°ã€‚

## ğŸ“¦ æ„å»ºç”Ÿäº§ç‰ˆæœ¬

åœ¨éƒ¨ç½²å‰ï¼Œé¦–å…ˆéœ€è¦æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼š

```bash
npm run build
```

è¿™ä¼šåœ¨ `.next` ç›®å½•åˆ›å»ºä¼˜åŒ–åçš„ç”Ÿäº§ç‰ˆæœ¬ã€‚

---

## ğŸŒ éƒ¨ç½²é€‰é¡¹

### é€‰é¡¹ 1: Vercelï¼ˆæ¨èï¼‰

Vercel æ˜¯ Next.js çš„å®˜æ–¹æ‰˜ç®¡å¹³å°ï¼Œéƒ¨ç½²æœ€ç®€å•ã€‚

#### é€šè¿‡ Vercel CLI éƒ¨ç½²

1. å®‰è£… Vercel CLIï¼š
```bash
npm i -g vercel
```

2. ç™»å½•å¹¶éƒ¨ç½²ï¼š
```bash
vercel
```

3. æŒ‰ç…§æç¤ºå®Œæˆéƒ¨ç½²

#### é€šè¿‡ GitHub è‡ªåŠ¨éƒ¨ç½²

1. å°†ä»£ç æ¨é€åˆ° GitHub
2. è®¿é—® [vercel.com](https://vercel.com)
3. å¯¼å…¥æ‚¨çš„ GitHub ä»“åº“
4. Vercel ä¼šè‡ªåŠ¨æ£€æµ‹ Next.js é¡¹ç›®å¹¶éƒ¨ç½²

**ä¼˜ç‚¹**ï¼š
- è‡ªåŠ¨åŒ–éƒ¨ç½²
- å…¨çƒ CDN
- é›¶é…ç½®
- å…è´¹é¢åº¦å……è¶³

---

### é€‰é¡¹ 2: Netlify

1. æ„å»ºé¡¹ç›®ï¼š
```bash
npm run build
```

2. åˆ›å»º `netlify.toml` é…ç½®æ–‡ä»¶ï¼š
```toml
[build]
  command = "npm run build"
  publish = ".next"

[[plugins]]
  package = "@netlify/plugin-nextjs"
```

3. éƒ¨ç½²ï¼š
- é€šè¿‡ Netlify CLIï¼š`netlify deploy --prod`
- æˆ–é€šè¿‡ [netlify.com](https://netlify.com) ç½‘é¡µç•Œé¢

---

### é€‰é¡¹ 3: GitHub Pagesï¼ˆé™æ€å¯¼å‡ºï¼‰

Next.js å¯ä»¥å¯¼å‡ºä¸ºçº¯é™æ€ HTMLã€‚

1. ä¿®æ”¹ `next.config.js`ï¼š
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'export',
  images: {
    unoptimized: true,
  },
}

module.exports = nextConfig
```

2. æ„å»ºé™æ€æ–‡ä»¶ï¼š
```bash
npm run build
```

3. `out` ç›®å½•åŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶ï¼Œå¯ä»¥éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡æœåŠ¡

4. éƒ¨ç½²åˆ° GitHub Pagesï¼š
```bash
# å‡è®¾æ‚¨å·²ç»é…ç½®å¥½ GitHub Pages
npm run build
git add out
git commit -m "Deploy to GitHub Pages"
git subtree push --prefix out origin gh-pages
```

---

### é€‰é¡¹ 4: è‡ªæ‰˜ç®¡

å¦‚æœæ‚¨æœ‰è‡ªå·±çš„æœåŠ¡å™¨ï¼š

1. æ„å»ºé¡¹ç›®ï¼š
```bash
npm run build
```

2. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ï¼š
```bash
npm run start
```

3. ä½¿ç”¨ PM2 ä¿æŒæœåŠ¡è¿è¡Œï¼š
```bash
# å®‰è£… PM2
npm i -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start npm --name "opml-gardener" -- start

# ä¿å­˜é…ç½®
pm2 save

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
```

4. é…ç½® Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

---

### é€‰é¡¹ 5: Docker éƒ¨ç½²

1. åˆ›å»º `Dockerfile`ï¼š
```dockerfile
FROM node:20-alpine AS deps
WORKDIR /app
COPY package*.json ./
RUN npm ci

FROM node:20-alpine AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npm run build

FROM node:20-alpine AS runner
WORKDIR /app
ENV NODE_ENV production

COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

EXPOSE 3000
ENV PORT 3000

CMD ["node", "server.js"]
```

2. ä¿®æ”¹ `next.config.js` æ·»åŠ  standalone è¾“å‡ºï¼š
```javascript
const nextConfig = {
  output: 'standalone',
}
```

3. æ„å»ºå’Œè¿è¡Œï¼š
```bash
docker build -t opml-gardener .
docker run -p 3000:3000 opml-gardener
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡

ç”±äº OPML Gardener æ˜¯çº¯å®¢æˆ·ç«¯åº”ç”¨ï¼Œä¸éœ€è¦ä»»ä½•åç«¯ API æˆ–ç¯å¢ƒå˜é‡ã€‚

---

## ğŸ”’ HTTPS é…ç½®

### ä½¿ç”¨ Vercel/Netlify
è‡ªåŠ¨æä¾›å…è´¹çš„ SSL è¯ä¹¦ã€‚

### è‡ªæ‰˜ç®¡ä½¿ç”¨ Let's Encrypt
```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¯ç”¨å‹ç¼©**ï¼šNext.js è‡ªåŠ¨å¯ç”¨ gzip å‹ç¼©
2. **CDN åŠ é€Ÿ**ï¼šä½¿ç”¨ Vercel æˆ– Netlify è‡ªåŠ¨è·å¾—å…¨çƒ CDN
3. **ç¼“å­˜ç­–ç•¥**ï¼šé™æ€èµ„æºè‡ªåŠ¨æ·»åŠ ç¼“å­˜å¤´
4. **å›¾ç‰‡ä¼˜åŒ–**ï¼šé¡¹ç›®ä¸­æœªä½¿ç”¨å¤§é‡å›¾ç‰‡ï¼Œå·²æ˜¯æœ€ä¼˜

---

## ğŸ§ª éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

- [ ] è¿è¡Œ `npm run build` ç¡®ä¿æ— æ„å»ºé”™è¯¯
- [ ] æµ‹è¯•ç”Ÿäº§ç‰ˆæœ¬ `npm run start`
- [ ] æ£€æŸ¥æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] ç¡®è®¤å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] ä½¿ç”¨ç¤ºä¾‹æ–‡ä»¶ `example.opml` æµ‹è¯•

---

## ğŸ“ˆ ç›‘æ§å’Œåˆ†æï¼ˆå¯é€‰ï¼‰

### æ·»åŠ  Google Analytics

åœ¨ `app/layout.tsx` çš„ `<head>` ä¸­æ·»åŠ ï¼š

```tsx
<Script
  src={`https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID`}
  strategy="afterInteractive"
/>
<Script id="google-analytics" strategy="afterInteractive">
  {`
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GA_MEASUREMENT_ID');
  `}
</Script>
```

---

## ğŸ†˜ å¸¸è§éƒ¨ç½²é—®é¢˜

### é—®é¢˜ï¼šæ„å»ºå¤±è´¥
**è§£å†³**ï¼š
- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆå»ºè®® 18.17+ï¼‰
- åˆ é™¤ `node_modules` å’Œ `.next`ï¼Œé‡æ–°å®‰è£…ä¾èµ–
- æ£€æŸ¥æ˜¯å¦æœ‰ TypeScript é”™è¯¯

### é—®é¢˜ï¼šéƒ¨ç½²åé¡µé¢ç©ºç™½
**è§£å†³**ï¼š
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
- ç¡®è®¤é™æ€èµ„æºè·¯å¾„æ­£ç¡®
- å¦‚ä½¿ç”¨å­è·¯å¾„éƒ¨ç½²ï¼Œé…ç½® `basePath` å’Œ `assetPrefix`

### é—®é¢˜ï¼šæ–‡ä»¶ä¸Šä¼ ä¸å·¥ä½œ
**è§£å†³**ï¼š
- è¿™æ˜¯å®¢æˆ·ç«¯åŠŸèƒ½ï¼Œæ£€æŸ¥æµè§ˆå™¨çš„ File API æ”¯æŒ
- æ£€æŸ¥ HTTPS é…ç½®ï¼ˆæŸäº›æµè§ˆå™¨è¦æ±‚ï¼‰

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å°±æ‹¥æœ‰äº†ä¸€ä¸ªå®Œå…¨æœ¬åœ°åŒ–ã€ä¿æŠ¤éšç§çš„ OPML ç®¡ç†å·¥å…·ï¼

**ç¤ºä¾‹éƒ¨ç½² URL**ï¼š
- Vercel: `https://opml-gardener.vercel.app`
- Netlify: `https://opml-gardener.netlify.app`
- è‡ªå®šä¹‰åŸŸå: `https://your-domain.com`

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ [Next.js éƒ¨ç½²æ–‡æ¡£](https://nextjs.org/docs/deployment)ã€‚

